{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport CouponModal from '@/components/CouponModal.vue';\nimport DelModal from '@/components/DelModal.vue';\nexport default {\n  components: {\n    CouponModal,\n    DelModal\n  },\n  data() {\n    return {\n      products: [],\n      product: {},\n      status: {\n        loadingItem: ''\n      },\n      form: {\n        user: {\n          name: '',\n          email: '',\n          tel: '',\n          address: ''\n        },\n        productNames: '',\n        // 新增的品名\n        finalTotal: 0,\n        // 新增的總計\n        message: ''\n      },\n      cart: {\n        items: [],\n        total: 0,\n        final_total: 0\n      },\n      coupon_code: '',\n      appliedDiscount: 1,\n      coupons: []\n    };\n  },\n  computed: {\n    discountedTotal() {\n      return this.cart.total * this.appliedDiscount;\n    }\n  },\n  watch: {\n    'cart.items': {\n      deep: true,\n      handler() {\n        this.updateCartTotals();\n      }\n    }\n  },\n  methods: {\n    async getProducts() {\n      const url = `/api/product-data`;\n      try {\n        const response = await this.$http.get(url);\n        this.products = response.data;\n      } catch (error) {\n        console.error(\"Error fetching products:\", error);\n      }\n    },\n    getProduct(id) {\n      this.$router.push(`/user/product/${id}`);\n    },\n    addCart(productID) {\n      const productToAdd = this.products.find(product => product.id === productID);\n      if (productToAdd) {\n        const existingItem = this.cart.items.find(item => item.product.id === productID);\n        if (existingItem) {\n          existingItem.qty++;\n        } else {\n          const cartItem = {\n            product: {\n              id: productToAdd.id,\n              title: productToAdd.title,\n              price: productToAdd.price || productToAdd.origin_price,\n              unit: productToAdd.unit\n            },\n            qty: 1\n          };\n          this.cart.items.push(cartItem);\n        }\n      }\n    },\n    removeCartItemByProductId(productId) {\n      this.cart.items = this.cart.items.filter(item => item.product.id !== productId);\n    },\n    updateCartQuantityByProductId(productId, qty) {\n      const item = this.cart.items.find(item => item.product.id === productId);\n      if (item) {\n        item.qty = qty;\n      }\n    },\n    getCart() {},\n    async validateAndApplyCoupon() {\n      const url = `/api/coupons/validate/${this.coupon_code}`;\n      try {\n        const response = await this.$http.get(url);\n        const coupon = response.data;\n        if (coupon.isEnabled) {\n          this.appliedDiscount = 1 - coupon.percent / 100;\n          this.cart.final_total = this.cart.total * this.appliedDiscount;\n        } else {\n          alert(\"此優惠券已被禁用！\");\n          this.appliedDiscount = 1;\n          this.cart.final_total = this.cart.total;\n        }\n      } catch (error) {\n        if (error.response && error.response.status === 404) {\n          alert(\"優惠券不存在！\");\n        } else {\n          alert(\"優惠券驗證出錯！\");\n        }\n        console.error(\"Error applying coupon:\", error);\n        this.appliedDiscount = 1;\n        this.cart.final_total = this.cart.total;\n      }\n    },\n    addCouponCode() {\n      this.validateAndApplyCoupon();\n    },\n    async createOrder() {\n      // 將購物車中的所有商品名稱組合成一個字串\n      const productNames = this.cart.items.map(item => item.product.title).join(\", \");\n      const orderData = {\n        email: this.form.user.email,\n        recipientName: this.form.user.name,\n        recipientPhone: this.form.user.tel,\n        recipientAddress: this.form.user.address,\n        message: this.form.message,\n        productNames: productNames,\n        finalTotal: this.cart.final_total\n      };\n      const url = `/api/user_orders`;\n      try {\n        const response = await this.$http.post(url, orderData);\n        console.log(response);\n      } catch (error) {\n        console.error(\"Error creating order:\", error);\n        // 如果響應中有數據，則打印出來\n        if (error.response && error.response.data) {\n          console.error(\"Server Response:\", error.response.data);\n        }\n      }\n    },\n    async getCoupons() {\n      const url = `/api/coupons`;\n      try {\n        const response = await this.$http.get(url);\n        this.coupons = response.data.map(coupon => ({\n          ...coupon,\n          due_date: coupon.dueDate\n        }));\n      } catch (error) {\n        console.error(\"Error fetching coupons:\", error);\n      }\n    },\n    formatDate(timestamp) {\n      const date = new Date(timestamp);\n      return date.toLocaleDateString();\n    },\n    async updateOrCreateCoupon(coupon) {\n      if (this.isNew) {\n        await this.createCoupon(coupon);\n      } else {\n        await this.updateCoupon(coupon);\n      }\n    },\n    async createCoupon(newCoupon) {\n      const api = `/api/coupons`;\n      try {\n        await this.$http.post(api, newCoupon);\n        this.getCoupons();\n      } catch (error) {\n        console.error(\"Error creating coupon:\", error);\n      }\n    },\n    async updateCoupon(updatedCoupon) {\n      const api = `/api/coupons/${updatedCoupon.id}`;\n      try {\n        await this.$http.put(api, updatedCoupon);\n        this.getCoupons();\n      } catch (error) {\n        console.error(\"Error updating coupon:\", error);\n      }\n    },\n    async delCoupon() {\n      const api = `/api/coupons/${this.tempCoupon.id}`;\n      try {\n        await this.$http.delete(api);\n        this.getCoupons();\n      } catch (error) {\n        console.error(\"Error deleting coupon:\", error);\n      }\n    },\n    updateCartTotals() {\n      this.cart.total = this.cart.items.reduce((acc, item) => {\n        return acc + item.product.price * item.qty;\n      }, 0);\n      this.cart.final_total = this.cart.total * this.appliedDiscount;\n    }\n  },\n  created() {\n    this.getProducts();\n    this.getCoupons();\n  },\n  filters: {\n    currency(value) {\n      return value.toLocaleString('zh-TW', {\n        style: 'currency',\n        currency: 'TWD'\n      });\n    }\n  }\n};","map":{"version":3,"names":["CouponModal","DelModal","components","data","products","product","status","loadingItem","form","user","name","email","tel","address","productNames","finalTotal","message","cart","items","total","final_total","coupon_code","appliedDiscount","coupons","computed","discountedTotal","watch","deep","handler","updateCartTotals","methods","getProducts","url","response","$http","get","error","console","getProduct","id","$router","push","addCart","productID","productToAdd","find","existingItem","item","qty","cartItem","title","price","origin_price","unit","removeCartItemByProductId","productId","filter","updateCartQuantityByProductId","getCart","validateAndApplyCoupon","coupon","isEnabled","percent","alert","addCouponCode","createOrder","map","join","orderData","recipientName","recipientPhone","recipientAddress","post","log","getCoupons","due_date","dueDate","formatDate","timestamp","date","Date","toLocaleDateString","updateOrCreateCoupon","isNew","createCoupon","updateCoupon","newCoupon","api","updatedCoupon","put","delCoupon","tempCoupon","delete","reduce","acc","created","filters","currency","value","toLocaleString","style"],"sources":["C:\\Users\\2409\\Desktop\\新增資料夾 (18)\\vue3\\src\\views\\UserCart.vue"],"sourcesContent":["<template>\r\n  <Loading :active=\"isLoading\"></Loading>\r\n  <div class=\"container\">\r\n    <div class=\"row mt-4\">\r\n      <div class=\"col-md-7\">\r\n        <table class=\"table align-middle\">\r\n          <thead>\r\n            <tr>\r\n              <th>圖片</th>\r\n              <th>商品名稱</th>\r\n              <th>價格</th>\r\n              <th></th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"item in products\" :key=\"item.id\">\r\n              <td style=\"width: 200px\">\r\n                <div\r\n                  style=\"\r\n                    height: 100px;\r\n                    background-size: cover;\r\n                    background-position: center;\r\n                  \"\r\n                  :style=\"{ backgroundImage: `url(${item.imageUrl})` }\"\r\n                ></div>\r\n              </td>\r\n              <td>\r\n                <a href=\"#\" class=\"text-dark\">{{ item.title }}</a>\r\n              </td>\r\n              <td>\r\n                <div class=\"h5\" v-if=\"!item.price\">\r\n                  {{ item.origin_price }} 元\r\n                </div>\r\n                <del class=\"h6\" v-if=\"item.price\">\r\n                  原價 {{ item.origin_price }} 元\r\n                </del>\r\n                <div class=\"h5\" v-if=\"item.price\">\r\n                  現在只要 {{ item.price }} 元\r\n                </div>\r\n              </td>\r\n              <td>\r\n                <div class=\"btn-group btn-group-sm\">\r\n                  <button\r\n                    type=\"button\"\r\n                    class=\"btn btn-outline-secondary\"\r\n                    @click=\"getProduct(item.id)\"\r\n                  >\r\n                    查看更多\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    class=\"btn btn-outline-danger\"\r\n                    :disabled=\"this.status.loadingItem === item.id\"\r\n                    @click=\"addCart(item.id)\"\r\n                  >\r\n                    <div\r\n                      v-if=\"this.status.loadingItem === item.id\"\r\n                      class=\"spinner-grow text-danger spinner-grow-sm\"\r\n                      role=\"status\"\r\n                    >\r\n                      <span class=\"visually-hidden\">Loading...</span>\r\n                    </div>\r\n                    加到購物車\r\n                  </button>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n      <!-- 購物車列表 -->\r\n      <div class=\"col-md-5\">\r\n        <div class=\"sticky-top\">\r\n            <table class=\"table align-middle\">\r\n                <thead>\r\n                    <tr>\r\n                        <th></th>\r\n                        <th>品名</th>\r\n                        <th style=\"width: 110px\">數量</th>\r\n                        <th>單價</th>\r\n                        <th>總價</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <template v-if=\"cart.items.length\">\r\n                    <tr v-for=\"item in cart.items\" :key=\"item.product.id\">\r\n                      <td>\r\n                        <button\r\n                          type=\"button\"\r\n                          class=\"btn btn-outline-danger btn-sm\"\r\n                          @click=\"removeCartItemByProductId(item.product.id)\"\r\n                        >\r\n                          <i class=\"bi bi-x\"></i>\r\n                        </button>\r\n                      </td>\r\n                      <td>{{ item.product.title }}</td>\r\n                      <td>\r\n                        <div class=\"input-group input-group-sm\">\r\n                          <input\r\n                            type=\"number\"\r\n                            class=\"form-control\"\r\n                            min=\"1\"\r\n                            v-model.number=\"item.qty\"\r\n                            @change=\"updateCartQuantityByProductId(item.product.id, item.qty)\"\r\n                          />\r\n                          <div class=\"input-group-text\">\r\n                            / {{ item.product.unit }}\r\n                          </div>\r\n                        </div>\r\n                      </td>\r\n                      <td>{{ item.product.price }} 元</td>\r\n                      <td>{{ item.product.price * item.qty }} 元</td>\r\n                    </tr>\r\n                  </template>\r\n                </tbody>\r\n                <tfoot>\r\n                    <tr>\r\n                        <td colspan=\"4\" class=\"text-end\">總計</td>\r\n                        <td class=\"text-end\">{{ $filters.currency(cart.total) }}</td>\r\n                    </tr>\r\n                    <tr v-if=\"cart.final_total !== cart.total\">\r\n                        <td colspan=\"4\" class=\"text-end text-success\">折扣價</td>\r\n                        <td class=\"text-end text-success\">\r\n                            {{ $filters.currency(cart.final_total) }}\r\n                        </td>\r\n                    </tr>\r\n                </tfoot>\r\n            </table>\r\n            <div class=\"input-group mb-3 input-group-sm\">\r\n                <input\r\n                  type=\"text\"\r\n                  class=\"form-control\"\r\n                  v-model=\"coupon_code\"\r\n                  placeholder=\"請輸入優惠碼\"\r\n                />\r\n                <div class=\"input-group-append\">\r\n                    <button\r\n                      class=\"btn btn-outline-secondary\"\r\n                      type=\"button\"\r\n                      @click=\"addCouponCode\"\r\n                    >\r\n                      套用優惠碼\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    </div>\r\n\r\n    <div class=\"my-5 row justify-content-center\">\r\n      <Form class=\"col-md-6\" v-slot=\"{ errors }\" @submit=\"createOrder\">\r\n        <div class=\"mb-3\">\r\n          <label for=\"email\" class=\"form-label\">Email</label>\r\n          <Field\r\n            id=\"email\"\r\n            name=\"email\"\r\n            type=\"email\"\r\n            class=\"form-control\"\r\n            :class=\"{ 'is-invalid': errors['email'] }\"\r\n            placeholder=\"請輸入 Email\"\r\n            rules=\"email|required\"\r\n            v-model=\"form.user.email\"\r\n          ></Field>\r\n          <ErrorMessage name=\"email\" class=\"invalid-feedback\"></ErrorMessage>\r\n        </div>\r\n\r\n        <div class=\"mb-3\">\r\n          <label for=\"name\" class=\"form-label\">收件人姓名</label>\r\n          <Field\r\n            id=\"name\"\r\n            name=\"姓名\"\r\n            type=\"text\"\r\n            class=\"form-control\"\r\n            :class=\"{ 'is-invalid': errors['姓名'] }\"\r\n            placeholder=\"請輸入姓名\"\r\n            rules=\"required\"\r\n            v-model=\"form.user.name\"\r\n          ></Field>\r\n          <ErrorMessage name=\"姓名\" class=\"invalid-feedback\"></ErrorMessage>\r\n        </div>\r\n\r\n        <div class=\"mb-3\">\r\n          <label for=\"tel\" class=\"form-label\">收件人電話</label>\r\n          <Field\r\n            id=\"tel\"\r\n            name=\"電話\"\r\n            type=\"tel\"\r\n            class=\"form-control\"\r\n            :class=\"{ 'is-invalid': errors['電話'] }\"\r\n            placeholder=\"請輸入電話\"\r\n            rules=\"required\"\r\n            v-model=\"form.user.tel\"\r\n          ></Field>\r\n          <ErrorMessage name=\"電話\" class=\"invalid-feedback\"></ErrorMessage>\r\n        </div>\r\n\r\n        <div class=\"mb-3\">\r\n          <label for=\"address\" class=\"form-label\">收件人地址</label>\r\n          <Field\r\n            id=\"address\"\r\n            name=\"地址\"\r\n            type=\"text\"\r\n            class=\"form-control\"\r\n            :class=\"{ 'is-invalid': errors['地址'] }\"\r\n            placeholder=\"請輸入地址\"\r\n            rules=\"required\"\r\n            v-model=\"form.user.address\"\r\n          ></Field>\r\n          <ErrorMessage name=\"地址\" class=\"invalid-feedback\"></ErrorMessage>\r\n        </div>\r\n\r\n        <div class=\"mb-3\">\r\n          <label for=\"message\" class=\"form-label\">留言</label>\r\n          <textarea\r\n            name=\"\"\r\n            id=\"message\"\r\n            class=\"form-control\"\r\n            cols=\"30\"\r\n            rows=\"10\"\r\n            v-model=\"form.message\"\r\n          ></textarea>\r\n        </div>\r\n        <div class=\"text-end\">\r\n          <button class=\"btn btn-danger\">送出訂單</button>\r\n        </div>\r\n      </Form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CouponModal from '@/components/CouponModal.vue';\r\nimport DelModal from '@/components/DelModal.vue';\r\n\r\nexport default {\r\n  components: { CouponModal, DelModal },\r\n  data() {\r\n    return {\r\n      products: [],\r\n      product: {},\r\n      status: {\r\n        loadingItem: ''\r\n      },\r\n      form: {\r\n        user: {\r\n          name: '',\r\n          email: '',\r\n          tel: '',\r\n          address: ''\r\n        },\r\n        productNames: '',  // 新增的品名\r\n        finalTotal: 0,    // 新增的總計\r\n        message: ''\r\n      },\r\n      cart: {\r\n        items: [],\r\n        total: 0,\r\n        final_total: 0\r\n      },\r\n      coupon_code: '',\r\n      appliedDiscount: 1,\r\n      coupons: []\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    discountedTotal() {\r\n      return this.cart.total * this.appliedDiscount;\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    'cart.items': {\r\n      deep: true,\r\n      handler() {\r\n        this.updateCartTotals();\r\n      }\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    async getProducts() {\r\n      const url = `/api/product-data`;\r\n      try {\r\n        const response = await this.$http.get(url);\r\n        this.products = response.data;\r\n      } catch (error) {\r\n        console.error(\"Error fetching products:\", error);\r\n      }\r\n    },\r\n\r\n    getProduct(id) {\r\n      this.$router.push(`/user/product/${id}`);\r\n    },\r\n\r\n    addCart(productID) {\r\n      const productToAdd = this.products.find(product => product.id === productID);\r\n      if (productToAdd) {\r\n        const existingItem = this.cart.items.find(item => item.product.id === productID);\r\n        if(existingItem) {\r\n          existingItem.qty++;\r\n        } else {\r\n          const cartItem = {\r\n            product: {\r\n              id: productToAdd.id,\r\n              title: productToAdd.title,\r\n              price: productToAdd.price || productToAdd.origin_price,\r\n              unit: productToAdd.unit\r\n            },\r\n            qty: 1\r\n          };\r\n          this.cart.items.push(cartItem);\r\n        }\r\n      }\r\n    },\r\n\r\n    removeCartItemByProductId(productId) {\r\n      this.cart.items = this.cart.items.filter(item => item.product.id !== productId);\r\n    },\r\n\r\n    updateCartQuantityByProductId(productId, qty) {\r\n      const item = this.cart.items.find(item => item.product.id === productId);\r\n      if(item) {\r\n        item.qty = qty;\r\n      }\r\n    },\r\n\r\n    getCart() {},\r\n\r\n    async validateAndApplyCoupon() {\r\n      const url = `/api/coupons/validate/${this.coupon_code}`;\r\n      try {\r\n        const response = await this.$http.get(url);\r\n        const coupon = response.data;\r\n        if (coupon.isEnabled) {\r\n          this.appliedDiscount = 1 - (coupon.percent / 100);\r\n          this.cart.final_total = this.cart.total * this.appliedDiscount;\r\n        } else {\r\n          alert(\"此優惠券已被禁用！\");\r\n          this.appliedDiscount = 1;\r\n          this.cart.final_total = this.cart.total;\r\n        }\r\n      } catch (error) {\r\n        if (error.response && error.response.status === 404) {\r\n          alert(\"優惠券不存在！\");\r\n        } else {\r\n          alert(\"優惠券驗證出錯！\");\r\n        }\r\n        console.error(\"Error applying coupon:\", error);\r\n        this.appliedDiscount = 1;\r\n        this.cart.final_total = this.cart.total;\r\n      }\r\n    },\r\n\r\n    addCouponCode() {\r\n      this.validateAndApplyCoupon();\r\n    },\r\n    async createOrder() {\r\n  // 將購物車中的所有商品名稱組合成一個字串\r\n  const productNames = this.cart.items.map(item => item.product.title).join(\", \");\r\n\r\n  const orderData = {\r\n    email: this.form.user.email,\r\n    recipientName: this.form.user.name,\r\n    recipientPhone: this.form.user.tel,\r\n    recipientAddress: this.form.user.address,\r\n    message: this.form.message,\r\n    productNames: productNames,\r\n    finalTotal: this.cart.final_total\r\n  };\r\n\r\n  const url = `/api/user_orders`;\r\n  try {\r\n    const response = await this.$http.post(url, orderData);\r\n    console.log(response);\r\n  } catch (error) {\r\n    console.error(\"Error creating order:\", error);\r\n    // 如果響應中有數據，則打印出來\r\n    if (error.response && error.response.data) {\r\n      console.error(\"Server Response:\", error.response.data);\r\n    }\r\n  }\r\n},\r\n\r\n\r\n\r\n    async getCoupons() {\r\n      const url = `/api/coupons`;\r\n      try {\r\n        const response = await this.$http.get(url);\r\n        this.coupons = response.data.map(coupon => ({\r\n          ...coupon,\r\n          due_date: coupon.dueDate\r\n        }));\r\n      } catch (error) {\r\n        console.error(\"Error fetching coupons:\", error);\r\n      }\r\n    },\r\n\r\n    formatDate(timestamp) {\r\n      const date = new Date(timestamp);\r\n      return date.toLocaleDateString();\r\n    },\r\n\r\n    async updateOrCreateCoupon(coupon) {\r\n      if (this.isNew) {\r\n        await this.createCoupon(coupon);\r\n      } else {\r\n        await this.updateCoupon(coupon);\r\n      }\r\n    },\r\n\r\n    async createCoupon(newCoupon) {\r\n      const api = `/api/coupons`;\r\n      try {\r\n        await this.$http.post(api, newCoupon);\r\n        this.getCoupons();\r\n      } catch (error) {\r\n        console.error(\"Error creating coupon:\", error);\r\n      }\r\n    },\r\n\r\n    async updateCoupon(updatedCoupon) {\r\n      const api = `/api/coupons/${updatedCoupon.id}`;\r\n      try {\r\n        await this.$http.put(api, updatedCoupon);\r\n        this.getCoupons();\r\n      } catch (error) {\r\n        console.error(\"Error updating coupon:\", error);\r\n      }\r\n    },\r\n\r\n    async delCoupon() {\r\n      const api = `/api/coupons/${this.tempCoupon.id}`;\r\n      try {\r\n        await this.$http.delete(api);\r\n        this.getCoupons();\r\n      } catch (error) {\r\n        console.error(\"Error deleting coupon:\", error);\r\n      }\r\n    },\r\n\r\n    updateCartTotals() {\r\n      this.cart.total = this.cart.items.reduce((acc, item) => {\r\n        return acc + (item.product.price * item.qty);\r\n      }, 0);\r\n      this.cart.final_total = this.cart.total * this.appliedDiscount;\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.getProducts();\r\n    this.getCoupons();\r\n  },\r\n\r\n  filters: {\r\n    currency(value) {\r\n      return value.toLocaleString('zh-TW', { style: 'currency', currency: 'TWD' });\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
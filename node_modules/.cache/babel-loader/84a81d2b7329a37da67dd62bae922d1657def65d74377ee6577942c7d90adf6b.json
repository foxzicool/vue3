{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"my-4\"\n}, \"所有訂單\", -1 /* HOISTED */);\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"p\", null, \"Loading...\", -1 /* HOISTED */);\nconst _hoisted_5 = [_hoisted_4];\nconst _hoisted_6 = {\n  key: 1\n};\nconst _hoisted_7 = {\n  class: \"table\"\n};\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", null, \"Email\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"收件人姓名\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"收件人電話\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"收件人地址\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"留言\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"品名\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"總計\")])], -1 /* HOISTED */);\nconst _hoisted_9 = [\"innerHTML\"];\nconst _hoisted_10 = [\"innerHTML\"];\nconst _hoisted_11 = [\"innerHTML\"];\nconst _hoisted_12 = [\"innerHTML\"];\nconst _hoisted_13 = [\"innerHTML\"];\nconst _hoisted_14 = [\"innerHTML\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.searchQuery = $event),\n    placeholder: \"搜索...\",\n    class: \"form-control mb-3\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.searchQuery]]), $setup.isLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, _hoisted_5)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"table\", _hoisted_7, [_hoisted_8, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.filteredOrders, order => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: order.id,\n      class: _normalizeClass({\n        'highlight': order.matches\n      })\n    }, [_createElementVNode(\"td\", {\n      innerHTML: $setup.highlight(order.email)\n    }, null, 8 /* PROPS */, _hoisted_9), _createElementVNode(\"td\", {\n      innerHTML: $setup.highlight(order.recipientName)\n    }, null, 8 /* PROPS */, _hoisted_10), _createElementVNode(\"td\", {\n      innerHTML: $setup.highlight(order.recipientPhone)\n    }, null, 8 /* PROPS */, _hoisted_11), _createElementVNode(\"td\", {\n      innerHTML: $setup.highlight(order.recipientAddress)\n    }, null, 8 /* PROPS */, _hoisted_12), _createElementVNode(\"td\", {\n      innerHTML: $setup.highlight(order.message)\n    }, null, 8 /* PROPS */, _hoisted_13), _createElementVNode(\"td\", {\n      innerHTML: $setup.highlight(order.productNames)\n    }, null, 8 /* PROPS */, _hoisted_14), _createElementVNode(\"td\", null, _toDisplayString(order.finalTotal), 1 /* TEXT */)], 2 /* CLASS */);\n  }), 128 /* KEYED_FRAGMENT */))])])]))]);\n}","map":{"version":3,"names":["class","_createElementVNode","_hoisted_4","_createElementBlock","_hoisted_1","_hoisted_2","type","$setup","searchQuery","$event","placeholder","isLoading","_hoisted_3","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_Fragment","_renderList","filteredOrders","order","key","id","_normalizeClass","matches","innerHTML","highlight","email","recipientName","recipientPhone","recipientAddress","message","productNames","_toDisplayString","finalTotal"],"sources":["C:\\Users\\2409\\Desktop\\vue3最新\\vue3\\src\\views\\Orders.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <h2 class=\"my-4\">所有訂單</h2>\r\n\r\n    <input type=\"text\" v-model=\"searchQuery\" placeholder=\"搜索...\" class=\"form-control mb-3\">\r\n\r\n    <div v-if=\"isLoading\">\r\n      <p>Loading...</p>\r\n    </div>\r\n\r\n    <div v-else>\r\n      <table class=\"table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Email</th>\r\n            <th>收件人姓名</th>\r\n            <th>收件人電話</th>\r\n            <th>收件人地址</th>\r\n            <th>留言</th>\r\n            <th>品名</th> \r\n            <th>總計</th> \r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"order in filteredOrders\" :key=\"order.id\" :class=\"{ 'highlight': order.matches }\">\r\n            <td v-html=\"highlight(order.email)\"></td>\r\n            <td v-html=\"highlight(order.recipientName)\"></td>\r\n            <td v-html=\"highlight(order.recipientPhone)\"></td>\r\n            <td v-html=\"highlight(order.recipientAddress)\"></td>\r\n            <td v-html=\"highlight(order.message)\"></td>\r\n            <td v-html=\"highlight(order.productNames)\"></td>\r\n            <td>{{ order.finalTotal }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue';\r\nimport axios from 'axios';\r\nimport visitRecorder from '@/methods/visitRecorder';\r\n\r\nexport default {\r\n  name: 'Order',\r\n  setup() {\r\n    const orders = ref([]);\r\n    const isLoading = ref(false);\r\n    const searchQuery = ref(\"\");\r\n\r\n    visitRecorder.recordVisit('OrderPage');\r\n\r\n    const getOrders = () => {\r\n      const url = `/api/user_orders`;\r\n      isLoading.value = true;\r\n      axios.get(url).then((response) => {\r\n        orders.value = response.data.reverse();\r\n        isLoading.value = false;\r\n      }).catch(error => {\r\n        console.error('Failed to fetch orders:', error);\r\n        isLoading.value = false;\r\n      });\r\n    };\r\n\r\n    const filteredOrders = computed(() => {\r\n      if (!searchQuery.value) {\r\n        return orders.value.map(order => ({ ...order, matches: false }));\r\n      }\r\n      return orders.value\r\n        .map(order => {\r\n          const regex = new RegExp(searchQuery.value, 'gi');\r\n          const matches = Object.values(order).some(value => regex.test(value));\r\n          return { ...order, matches };\r\n        })\r\n        .filter(order => order.matches);\r\n    });\r\n\r\n    const highlight = (text) => {\r\n      if (!searchQuery.value) return text;\r\n      const regex = new RegExp(searchQuery.value, 'gi');\r\n      return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`);\r\n    };\r\n\r\n    onMounted(() => {\r\n      getOrders();\r\n    });\r\n\r\n    return {\r\n      orders,\r\n      isLoading,\r\n      searchQuery,\r\n      filteredOrders,\r\n      highlight\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.highlight {\r\n  color: red;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAW;gCACpBC,mBAAA,CAA0B;EAAtBD,KAAK,EAAC;AAAM,GAAC,MAAI;;;;gCAKnBC,mBAAA,CAAiB,WAAd,YAAU;oBAAbC,UAAiB,C;;;;;EAIVF,KAAK,EAAC;AAAO;gCAClBC,mBAAA,CAUQ,gB,aATNA,mBAAA,CAQK,a,aAPHA,mBAAA,CAAc,YAAV,OAAK,G,aACTA,mBAAA,CAAc,YAAV,OAAK,G,aACTA,mBAAA,CAAc,YAAV,OAAK,G,aACTA,mBAAA,CAAc,YAAV,OAAK,G,aACTA,mBAAA,CAAW,YAAP,IAAE,G,aACNA,mBAAA,CAAW,YAAP,IAAE,G,aACNA,mBAAA,CAAW,YAAP,IAAE,E;;;;;;;;uBAnBhBE,mBAAA,CAmCM,OAnCNC,UAmCM,GAlCJC,UAA0B,E,gBAE1BJ,mBAAA,CAAuF;IAAhFK,IAAI,EAAC,MAAM;+DAAUC,MAAA,CAAAC,WAAW,GAAAC,MAAA;IAAEC,WAAW,EAAC,OAAO;IAACV,KAAK,EAAC;iDAAvCO,MAAA,CAAAC,WAAW,E,GAE5BD,MAAA,CAAAI,SAAS,I,cAApBR,mBAAA,CAEM,OAAAS,UAAA,EAAAC,UAAA,M,cAENV,mBAAA,CAyBM,OAAAW,UAAA,GAxBJb,mBAAA,CAuBQ,SAvBRc,UAuBQ,GAtBNC,UAUQ,EACRf,mBAAA,CAUQ,iB,kBATNE,mBAAA,CAQKc,SAAA,QAAAC,WAAA,CAReX,MAAA,CAAAY,cAAc,EAAvBC,KAAK;yBAAhBjB,mBAAA,CAQK;MARgCkB,GAAG,EAAED,KAAK,CAACE,EAAE;MAAGtB,KAAK,EAAAuB,eAAA;QAAA,aAAiBH,KAAK,CAACI;MAAO;QACtFvB,mBAAA,CAAyC;MAArCwB,SAA+B,EAAvBlB,MAAA,CAAAmB,SAAS,CAACN,KAAK,CAACO,KAAK;yCACjC1B,mBAAA,CAAiD;MAA7CwB,SAAuC,EAA/BlB,MAAA,CAAAmB,SAAS,CAACN,KAAK,CAACQ,aAAa;0CACzC3B,mBAAA,CAAkD;MAA9CwB,SAAwC,EAAhClB,MAAA,CAAAmB,SAAS,CAACN,KAAK,CAACS,cAAc;0CAC1C5B,mBAAA,CAAoD;MAAhDwB,SAA0C,EAAlClB,MAAA,CAAAmB,SAAS,CAACN,KAAK,CAACU,gBAAgB;0CAC5C7B,mBAAA,CAA2C;MAAvCwB,SAAiC,EAAzBlB,MAAA,CAAAmB,SAAS,CAACN,KAAK,CAACW,OAAO;0CACnC9B,mBAAA,CAAgD;MAA5CwB,SAAsC,EAA9BlB,MAAA,CAAAmB,SAAS,CAACN,KAAK,CAACY,YAAY;0CACxC/B,mBAAA,CAA+B,YAAAgC,gBAAA,CAAxBb,KAAK,CAACc,UAAU,iB"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import { ref, onMounted, computed } from 'vue';\nimport axios from 'axios';\nimport visitRecorder from '@/methods/visitRecorder';\nexport default {\n  name: 'Order',\n  setup() {\n    const orders = ref([]);\n    const isLoading = ref(false);\n    const searchQuery = ref(\"\");\n    visitRecorder.recordVisit('OrderPage');\n    const getOrders = () => {\n      const url = `/api/user_orders`;\n      isLoading.value = true;\n      axios.get(url).then(response => {\n        orders.value = response.data;\n        isLoading.value = false;\n      }).catch(error => {\n        console.error('Failed to fetch orders:', error);\n        isLoading.value = false;\n      });\n    };\n    const filteredOrders = computed(() => {\n      if (!searchQuery.value) {\n        return orders.value.map(order => ({\n          ...order,\n          matches: false\n        }));\n      }\n      return orders.value.map(order => {\n        const regex = new RegExp(searchQuery.value, 'gi');\n        const matches = Object.values(order).some(value => regex.test(value));\n        return {\n          ...order,\n          matches\n        };\n      }).filter(order => order.matches);\n    });\n    const highlight = text => {\n      if (!searchQuery.value) return text;\n      const regex = new RegExp(searchQuery.value, 'gi');\n      return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`);\n    };\n    onMounted(() => {\n      getOrders();\n    });\n    return {\n      orders,\n      isLoading,\n      searchQuery,\n      filteredOrders,\n      highlight\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","axios","visitRecorder","name","setup","orders","isLoading","searchQuery","recordVisit","getOrders","url","value","get","then","response","data","catch","error","console","filteredOrders","map","order","matches","regex","RegExp","Object","values","some","test","filter","highlight","text","replace","match"],"sources":["C:\\Users\\2409\\Desktop\\vue3最新\\vue3\\src\\views\\Orders.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <h2 class=\"my-4\">所有訂單</h2>\r\n\r\n    <input type=\"text\" v-model=\"searchQuery\" placeholder=\"搜索...\" class=\"form-control mb-3\">\r\n\r\n    <div v-if=\"isLoading\">\r\n      <p>Loading...</p>\r\n    </div>\r\n\r\n    <div v-else>\r\n      <table class=\"table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Email</th>\r\n            <th>收件人姓名</th>\r\n            <th>收件人電話</th>\r\n            <th>收件人地址</th>\r\n            <th>留言</th>\r\n            <th>品名</th> \r\n            <th>總計</th> \r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"order in filteredOrders\" :key=\"order.id\" :class=\"{ 'highlight': order.matches }\">\r\n            <td v-html=\"highlight(order.email)\"></td>\r\n            <td v-html=\"highlight(order.recipientName)\"></td>\r\n            <td v-html=\"highlight(order.recipientPhone)\"></td>\r\n            <td v-html=\"highlight(order.recipientAddress)\"></td>\r\n            <td v-html=\"highlight(order.message)\"></td>\r\n            <td v-html=\"highlight(order.productNames)\"></td>\r\n            <td>{{ order.finalTotal }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue';\r\nimport axios from 'axios';\r\nimport visitRecorder from '@/methods/visitRecorder';\r\n\r\nexport default {\r\n  name: 'Order',\r\n  setup() {\r\n    const orders = ref([]);\r\n    const isLoading = ref(false);\r\n    const searchQuery = ref(\"\");\r\n\r\n    visitRecorder.recordVisit('OrderPage');\r\n\r\n    const getOrders = () => {\r\n      const url = `/api/user_orders`;\r\n      isLoading.value = true;\r\n      axios.get(url).then((response) => {\r\n        orders.value = response.data;\r\n        isLoading.value = false;\r\n      }).catch(error => {\r\n        console.error('Failed to fetch orders:', error);\r\n        isLoading.value = false;\r\n      });\r\n    };\r\n\r\n    const filteredOrders = computed(() => {\r\n      if (!searchQuery.value) {\r\n        return orders.value.map(order => ({ ...order, matches: false }));\r\n      }\r\n      return orders.value\r\n        .map(order => {\r\n          const regex = new RegExp(searchQuery.value, 'gi');\r\n          const matches = Object.values(order).some(value => regex.test(value));\r\n          return { ...order, matches };\r\n        })\r\n        .filter(order => order.matches);\r\n    });\r\n\r\n    const highlight = (text) => {\r\n      if (!searchQuery.value) return text;\r\n      const regex = new RegExp(searchQuery.value, 'gi');\r\n      return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`);\r\n    };\r\n\r\n    onMounted(() => {\r\n      getOrders();\r\n    });\r\n\r\n    return {\r\n      orders,\r\n      isLoading,\r\n      searchQuery,\r\n      filteredOrders,\r\n      highlight\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.highlight {\r\n  color: red;\r\n}\r\n</style>\r\n"],"mappings":"AAuCA,SAASA,GAAG,EAAEC,SAAS,EAAEC,QAAO,QAAS,KAAK;AAC9C,OAAOC,KAAI,MAAO,OAAO;AACzB,OAAOC,aAAY,MAAO,yBAAyB;AAEnD,eAAe;EACbC,IAAI,EAAE,OAAO;EACbC,KAAKA,CAAA,EAAG;IACN,MAAMC,MAAK,GAAIP,GAAG,CAAC,EAAE,CAAC;IACtB,MAAMQ,SAAQ,GAAIR,GAAG,CAAC,KAAK,CAAC;IAC5B,MAAMS,WAAU,GAAIT,GAAG,CAAC,EAAE,CAAC;IAE3BI,aAAa,CAACM,WAAW,CAAC,WAAW,CAAC;IAEtC,MAAMC,SAAQ,GAAIA,CAAA,KAAM;MACtB,MAAMC,GAAE,GAAK,kBAAiB;MAC9BJ,SAAS,CAACK,KAAI,GAAI,IAAI;MACtBV,KAAK,CAACW,GAAG,CAACF,GAAG,CAAC,CAACG,IAAI,CAAEC,QAAQ,IAAK;QAChCT,MAAM,CAACM,KAAI,GAAIG,QAAQ,CAACC,IAAI;QAC5BT,SAAS,CAACK,KAAI,GAAI,KAAK;MACzB,CAAC,CAAC,CAACK,KAAK,CAACC,KAAI,IAAK;QAChBC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;QAC/CX,SAAS,CAACK,KAAI,GAAI,KAAK;MACzB,CAAC,CAAC;IACJ,CAAC;IAED,MAAMQ,cAAa,GAAInB,QAAQ,CAAC,MAAM;MACpC,IAAI,CAACO,WAAW,CAACI,KAAK,EAAE;QACtB,OAAON,MAAM,CAACM,KAAK,CAACS,GAAG,CAACC,KAAI,KAAM;UAAE,GAAGA,KAAK;UAAEC,OAAO,EAAE;QAAM,CAAC,CAAC,CAAC;MAClE;MACA,OAAOjB,MAAM,CAACM,KAAI,CACfS,GAAG,CAACC,KAAI,IAAK;QACZ,MAAME,KAAI,GAAI,IAAIC,MAAM,CAACjB,WAAW,CAACI,KAAK,EAAE,IAAI,CAAC;QACjD,MAAMW,OAAM,GAAIG,MAAM,CAACC,MAAM,CAACL,KAAK,CAAC,CAACM,IAAI,CAAChB,KAAI,IAAKY,KAAK,CAACK,IAAI,CAACjB,KAAK,CAAC,CAAC;QACrE,OAAO;UAAE,GAAGU,KAAK;UAAEC;QAAQ,CAAC;MAC9B,CAAC,EACAO,MAAM,CAACR,KAAI,IAAKA,KAAK,CAACC,OAAO,CAAC;IACnC,CAAC,CAAC;IAEF,MAAMQ,SAAQ,GAAKC,IAAI,IAAK;MAC1B,IAAI,CAACxB,WAAW,CAACI,KAAK,EAAE,OAAOoB,IAAI;MACnC,MAAMR,KAAI,GAAI,IAAIC,MAAM,CAACjB,WAAW,CAACI,KAAK,EAAE,IAAI,CAAC;MACjD,OAAOoB,IAAI,CAACC,OAAO,CAACT,KAAK,EAAEU,KAAI,IAAM,2BAA0BA,KAAM,SAAQ,CAAC;IAChF,CAAC;IAEDlC,SAAS,CAAC,MAAM;MACdU,SAAS,EAAE;IACb,CAAC,CAAC;IAEF,OAAO;MACLJ,MAAM;MACNC,SAAS;MACTC,WAAW;MACXY,cAAc;MACdW;IACF,CAAC;EACH;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}